/**
 * Responsive carousel fit for asynchronous data
 * @version v0.0.2 - 2015-09-08
 * @link https://github.com/blakeandrewwood/angular-carousel-lite#readme
 * @author Blake Wood
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angularCarouselLite",[]),angular.module("angularCarouselLite").directive("carouselLite",["$timeout",function(a){return{restrict:"E",scope:{carouselClass:"=carouselClass",slideClass:"=slideClass"},link:function(b,c,d){function e(){f(),g(),i()}function f(){c.append('<div id="carousel" class="'+A+'"></div>'),y=$("#carousel"),y.css({position:"relative","background-color":"#fff",cursor:"pointer","overflow-x":"hidden","overflow-y":"hidden"})}function g(){y.append('<div id="carousel-track"></div>'),z=$("#carousel-track"),z.css({position:"absolute",top:"0",left:"0",height:"100%","white-space":"nowrap","box-sizing":"border-box"})}function h(){x&&a.cancel(x),x=a(function(){D.numSlides>0&&p(D.position)},250)}function i(){C=Math.floor(window.innerWidth/2),j()}function j(){var a=window.innerWidth,b=(z.outerWidth(),a+200);z.css("padding-left",b+"px"),z.css("padding-right",b+"px")}function k(b){l(b,function(){D.numSlides++,m(b),1==D.numSlides&&a(function(){D.position=0,p(0)},800)})}function l(a,b){var c=new Image;c.src=a,c.callback=b,c.onload=function(){this.callback()}}function m(a){var b="";b+='<div class="carousel-image '+B+'">',a&&(b+='<img style="height: 100%;" draggable="false" src="'+a+'">'),b+="</div>",z.append(b);var c=$(".carousel-image:last");c.css({display:"inline-block",position:"relative",top:"0",left:"0",height:"100%","vertical-align":"top","pointer-events":"none","box-sizing":"border-box"});var d=(c.position(),c.offset(),c.outerWidth()),e=c.outerHeight(),f=d/2,g=e/2;c.find(".image-center:first").css({top:g-40,left:f-40})}function n(){D.numSlides>0&&D.position<D.numSlides-1&&(D.position++,p(D.position,"next"))}function o(){D.position>0&&(D.position--,p(D.position,"prev"))}function p(a,b){var c=s(D.position);t(c,b)}function q(a){y.scrollLeft(a)}function r(a){var b=[],c=[];$(".carousel-image").each(function(){var a=$(this),d=u(a);d>0?b.push(d):c.push(d)});var d=Array.absMin(b),e=Array.absMin(c),f=d>e?-e:d,g=d>e?"prev":"next";"next"==g?D.position++:D.position--;var h=y.scrollLeft()+f;t(h,g)}function s(a){var b=$(".carousel-image").eq(a),c=u(b);return y.scrollLeft()+c}function t(a,b){v(b),y.animate({scrollLeft:a},100,function(){w(b)})}function u(a){var b=a.offset().left+a.outerWidth()/2;return b-C}function v(a){D.lastPosition=D.position-1}function w(a){}var x,y,z,A=d.carouselClass,B=d.slideClass,C=0,D={position:-1,lastPosition:-1,numSlides:0},E={button:null,grabbed:{x:0},scroll:{x:0},start:{x:0}};e(),$(window).resize(function(){i(),h()}),b.$on("carouselAdd",function(a,b){k(b.image)}),b.$on("carouselNext",function(a,b){n()}),b.$on("carouselPrev",function(a,b){o()}),z.mousedown(function(a){0===a.button?(E.button=0,E.grabbed.x=a.pageX,E.start.x=y.scrollLeft()):E.button=null}),$(document).mouseup(function(a){E.button=null}),z.mouseup(function(a){r(C)}),z.mousemove(function(a){if(0===E.button){var b=a.pageX;E.scroll.x=y.scrollLeft(),E.distance=E.start.x-b+E.grabbed.x,q(E.distance)}}),Array.absMin=function(a){return Math.min.apply(Math,a.map(Math.abs))}}}}]);