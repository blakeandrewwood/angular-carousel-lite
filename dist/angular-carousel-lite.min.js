/**
 * Responsive carousel fit for asynchronous data
 * @version v0.0.2 - 2015-09-08
 * @link https://github.com/blakeandrewwood/angular-carousel-lite#readme
 * @author Blake Wood
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angularCarouselLite",[]),angular.module("angularCarouselLite").directive("carouselLite",["$timeout",function(a){return{restrict:"E",scope:{carouselClass:"=carouselClass",slideClass:"=slideClass"},link:function(b,c,d){function e(){f(),g(),i()}function f(){c.append('<div id="carousel" class="'+E+'"></div>'),C=$("#carousel"),C.css({position:"relative","background-color":"#fff",cursor:"pointer","overflow-x":"hidden","overflow-y":"hidden"})}function g(){C.append('<div id="carousel-track"></div>'),D=$("#carousel-track"),D.css({position:"absolute",top:"0",left:"0",height:"100%","white-space":"nowrap","box-sizing":"border-box"})}function h(){B&&a.cancel(B),B=a(function(){H.numSlides>0&&p(H.position)},250)}function i(){G=Math.floor(window.innerWidth/2),j()}function j(){var a=window.innerWidth,b=(D.outerWidth(),a+200);D.css("padding-left",b+"px"),D.css("padding-right",b+"px")}function k(b){l(b,function(){H.numSlides++,m(b),y(b),1==H.numSlides&&a(function(){H.lastScroll.x=-9999,p(0)},800)})}function l(a,b){var c=new Image;c.src=a,c.callback=b,c.onload=function(){this.callback()}}function m(a){var b="";b+='<div class="carousel-image '+F+'">',a&&(b+='<img style="height: 100%;" draggable="false" src="'+a+'">'),b+="</div>",D.append(b);var c=$(".carousel-image:last");c.css({display:"inline-block",position:"relative",top:"0",left:"0",height:"100%","vertical-align":"top","pointer-events":"none","box-sizing":"border-box"});var d=(c.position(),c.offset(),c.outerWidth()),e=c.outerHeight(),f=d/2,g=e/2;c.find(".image-center:first").css({top:g-40,left:f-40})}function n(){if(H.numSlides>0&&H.position<H.numSlides-1){var a=H+1;p(a)}}function o(){if(H.position>0){var a=H-1;p(a)}}function p(a){var b=s(a);t(b)}function q(a){C.scrollLeft(a)}function r(a){var b=[],c=[];$(".carousel-image").each(function(){var a=$(this),d=v(a);d>0?b.push(d):c.push(d)});var d=Array.absMin(b),e=Array.absMin(c),f=d>e?-e:d,g=C.scrollLeft()+f;t(g)}function s(a){var b=$(".carousel-image").eq(a),c=v(b);return C.scrollLeft()+c}function t(a){w(),C.animate({scrollLeft:a},100,function(){var a=u();x(a)})}function u(){var a="none";return H.lastScroll.x<C.scrollLeft()?(a="next",H.position++):H.lastScroll.x>C.scrollLeft()&&(a="prev",H.position--),a}function v(a){var b=a.offset().left+a.outerWidth()/2;return b-G}function w(){z()}function x(a){H.lastScroll.x=C.scrollLeft(),A(a)}function y(a){b.$emit("carouselEventImageLoaded",{src:a})}function z(){b.$emit("carouselEventPreScroll",{})}function A(a){b.$emit("carouselEventPostScroll",{position:H.position,direction:a})}var B,C,D,E=d.carouselClass,F=d.slideClass,G=0,H={position:-1,numSlides:0,lastScroll:{x:0}},I={button:null,grabbed:{x:0},scroll:{x:0},start:{x:0}};e(),$(window).resize(function(){i(),h()}),Array.absMin=function(a){return Math.min.apply(Math,a.map(Math.abs))},D.mousedown(function(a){0===a.button?(I.button=0,I.grabbed.x=a.pageX,I.start.x=C.scrollLeft()):I.button=null}),$(document).mouseup(function(a){I.button=null}),D.mouseup(function(a){r(G)}),D.mousemove(function(a){if(0===I.button){var b=a.pageX;I.scroll.x=C.scrollLeft(),I.distance=I.start.x-b+I.grabbed.x,q(I.distance)}}),b.$on("carouselAdd",function(a,b){k(b.image)}),b.$on("carouselNext",function(a,b){n()}),b.$on("carouselPrev",function(a,b){o()})}}}]);